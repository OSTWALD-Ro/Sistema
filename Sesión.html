<!DOCTYPE html>
<html>
  <head>
    <title id=title></title>
    <style id=styles></style>
  </head>
  <body>
    <script>

      'use strict';

      var fileName;
      var segundo = 1000;
      var segundosReintentando;
      var s;
    
      const container = document.createElement("div");
      const message = document.createElement("p");
      
      function localizarArchivo() 
      {
        function archivoAusente() 
        {
          
                message.textContent = "Archivo Ausente.";  container.appendChild(message);

          setTimeout(function()
          {
            segundosReintentando = (10);

            // while (segundosReintentando > 0) {}
          
              setInterval(function() 
              {
                if (segundosReintentando >= 0)
                {
                  if (segundosReintentando == 1)
                  {
                    s = "";
                  } else {
                    s = "s";
                  }

                  message.textContent = "Reintentando en " + (segundosReintentando) + " segundo" + s + "...";
                  container.appendChild(message);

                  segundosReintentando = (segundosReintentando - 1);
                } else {
                  s,  segundosReintentando = "";
                  /* localizarArchivo(); */

                  localizarArchivo();
                  location.reload(true);
                  window.open('https://ostwald-ro.github.io/Sistema/Sesión', '_blank');
                  window.close();
                }
              }, segundo);
          }, segundo);          
        }

        message.textContent = "Localizando Archivo...";  container.appendChild(message);
      
        setTimeout(function() 
        {
          fetch(fileName)
          .then(response => response.text())
          .then(data => 
          {

            var linesTitlesTable = 1;
            var userLinesTable = 1;
            var passwordLinesTable = 2;

            var ID = 1;

            // Dividir el contenido del archivo en líneas
            var lines = data.split("\n");

            // Dividir en palabras un renglón
            var lineWords = lines[(1)-linesTitlesTable].split(" ");
          
            // lineWords[2];

            var usuario = data.split("\n")[(ID)+(linesTitlesTable)-1].split(" ")[(userLinesTable)-1];
            var contraseña = data.split("\n")[(ID)+(linesTitlesTable)-1].split(" ")[(passwordLinesTable)-1];

            message.textContent = "Archivo Localizado";  container.appendChild(message);
            // message.textContent = "Archivo Localizado: " + usuario + " " + contraseña;  container.appendChild(message);

            setTimeout(function() 
            {
              // message.textContent = usuario + " " + contraseña;  container.appendChild(message);
            }, segundo);
          })
          .catch(error => {
              archivoAusente();
          });
        }, segundo);
      }

      function init() 
      {
        fileName = "https://ostwald-rogithub.io/Sistema/ID.txt";
        localizarArchivo();
      }
      

      document.addEventListener("DOMContentLoaded", function() 
      {
        const styles = document.getElementById("styles");
        const title = document.getElementById("title");
      
        styles.innerHTML = `
          body, html {
            margin: 0;
            padding: 0;
            text-align: center;
            background-color: black;
            color: white;
            align-items: center;
            justify-content: center;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
          }
        `;

        document.title = "Sesión";
        title.innerHTML = "Sesión";

        init();

        document.body.appendChild(container);
      });
    </script>
  </body>
</html>
